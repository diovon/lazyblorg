  CLOSED: [2016-11-06 So 16:30]
:LOGBOOK:
- State "DONE"       from ""           [2016-11-06 So 16:30]
:END:
:PROPERTIES:
:CREATED:  [2016-11-06 So 16:30]
:ID: 2016-11-06-nanobackup
:END:

In den letzen beiden Tagen habe ich mich erneut in das Nexus 5 verliebt.
Meine Eltern sind seit kurzer Zeit ebenfalls Nexus 5 Benutzer. Gestern musste leider eines davon eine unsanfte Landung absolvieren,
wodurch der Display in Mitleidenschaft gezogen wurde.

#+CAPTION: Nexus 5 mit Display Schaden
#+ATTR_HTML: :alt Nexus 5 mit Display Schaden
#+ATTR_HTML: :align center :width 560
[[tsfile:signal-2016-11-02-111036.jpg]]

Nun gab es zwei Möglichkeiten:

A) Display tauschen
B) gebrauchtes Nexus 5

Den geringsten Aufwand stellte für mich Möglichkeit B dar. Dank meines Bruders haben wir auch schnell über [[https://www.willhaben.at/iad][Willhaben]] ein passendes Angebot gefunden
und dieses innerhalb eines Tages abgeholt.

** Backup & Restore

Nun war das alte Nexus 5 noch betriebsbereit, wodurch ich die Möglichkeit hatte ein aktuelles Backup zu erzeugen.

Auch hier standen mir zwei Möglichkeiten zur Verfügung:

A) [[https://play.google.com/store/apps/details?id%3Dcom.keramidas.TitaniumBackup&hl%3Dde][Titanium Backup]]

B) TWRP Backup bzw. nandroid Backup

Und wieder habe ich mich für Variante B) entschieden. Für Titanium Backup müsste ich die kostenpflichtige Version kaufen und da ich eh das
komplette System wiederherstellen wollte, war aus meiner Sicht dies die einfachste und schnellste Variante. Per "adb pull" konnte ich das Backup
auf mein Notebook sichern.

Nun ging es dran, das Backup auf das neue Nexus einzuspielen. Nachdem das neue Gerät per "fastboot oem unlock" wieder gerootet habe, konnte ich
auch auf diesem TWRP installieren (fastboot flash recovery twrp-3.0.2-0-hammerhead.img). Ich habe danach am neuen Nexus ein Backup durchgeführt,
da TWRP die Backups in einen Ordner ablegt, der als Bezeichnung die Seriennummer des Smartphones enthält. Die Backupdateien selbst befinden sich
in einem weiteren Unterordner und [[http://androidforums.com/threads/verizon-solved-twrp-cannot-find-backup.654751/][TWRP findet Backup-Dateien]] auch nur unter diesen Ordner. Per adb push habe ich nun vom Notebook das Backup vom alten Nexus auf das neue Nexus übertragen. Nach der
Ausführung des Restores und einem Neustart war auf dem neuen Nexus 5 das System wie beim alten Nexus 5.

** Die Probleme

Nach der bisherigen Beschreibung kann man eins zu eins das System auf einem neuen Gerät kopieren, solange man nicht telefonieren oder
SMS schreiben will. Denn das Problem ist, dass durch die oben beschriebene Variante der interne EFS-Ordner überschrieben wird. Dieser enthält
die Information, welche IMEI-Nummer dem Smartphone zugeordnet ist. Durch das Überschreiben wird entweder eine ungültige IMEI Nummer oder die
IMEI Nummer wird auf 0 gesetzt. Das Problem ist nun, ohne IMEI Nummer kann sich das Smartphone nicht ins Mobilefunktnetz einwählen, dadurch
sind Anrufe oder SMS nicht möglich.

** Lösungsweg

Meine Recherchen haben ergeben, dass in Einzelfällen ein Überspielen des Systems mit Hilfe eines Factory-Image die alte IMEI Nummer wiederhergestellt
hat. Daraufhin habe ich diese [[http://www.pocketpc.ch/google-nexus-5-root-und-rom/200110-anleitung-nexus-5-stock-zustand-zuruecksetzen-via-offiziellem-factory-image.html][Anleitung]] befolgt und das Factory-Image eingespielt. Leider hat dies nicht den gewünschten Erfolg gehabt und
die IMEI Nummer war noch immer auf den Wert 0 gesetzt.

Als nächstes versuchte ich mit folgender [[http://forum.xda-developers.com/showpost.php?p%3D26827676&postcount%3D4512%2522][Anleitung]] die IMEI Nummer zu reparieren oder wenigstens durch eine Entwickler IMEI Nummer zu ersetzen.
Allerdings dürfte sich die Ordner Struktur von Android geändert haben, wodurch ich den EFS-Ordner nicht im root-Verzeichnis finden konnte.
Auch nicht auf meinem eigenen Nexus 5, wo der EFS-Ordner korrekt ist und ich eine IMEI Nummer besitze.

Schlussendlich bin ich bei folgender [[http://android.stackexchange.com/questions/114184/restore-google-nexus-5-imei-that-reads-0][Anleitung]] gelandet. Dieser Forumbeitrag beschrieb ganz genau mein Problem und ich hatte endlich die Lösung
in Händen. Dachte ich mir. Denn in dem Forumbeitrag wird die Lösung anhand eines Windowsprogamms beschrieben. Ich habe bei mir privat allerdings
nur Linux im Einsatz, außer einen alten Pentium 4, der mir ab und zu als Spielerechner dient. Zu erst versuchte ich die Windowstools unter
WINE auszuführen. Starten konnte ich die Programme schon, aber sie erkannten das Nexus 5 nicht. In weiteren Forumbeiträgen habe ich gelesen, dass
auch mit Virtuellen Maschinen das korrekte Ausführen der Programme nicht möglich war. Daher entschloss ich mich, meinen alten Pentium 4 zu
reaktivieren. Die beschriebenen Programme waren schnell installiert, allerdings hatte ich mit einer Grundlage starke Probleme: Installation
des LG NEXUS 5 Treibers. Nach 5 Stunden gab ich die Installationsversuche schließlich auf. Aus irgendeinem unbekannten Grund konnte mein
Windows PC die lokal vorhandenen Treiberdateien für die Installation nicht verwenden.

** Wichtigste Erfahrung

Was ich aus der ganzen Sache gelernt habe? Bevor du was tust, immer ein Backup ziehen! Und, der augenscheinlich schnellste Weg ist nicht immer
der mit den geringsten Problemen. Daher werde ich, wenn ich die IMEI Nummer wiederhergestellt habe, sofort ein Backup des EFS-Ordners durchführen.


